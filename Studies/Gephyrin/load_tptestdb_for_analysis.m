function db = load_tptestdb_for_analysis
%LOAD_TESTDB_FOR_ANALYSIS merges db for gephyrin puncta and interneuron staining analysis
%
% 2011, Alexander Heimel & Danielle van Versendaal
%

%MD data
db_daan_matched = load_testdb('tptestdb_olympus_daan_cycling_corrected_matched');
db_daan_matched = db_daan_matched(find_record(db_daan_matched, ...
    ['(mouse=10.24.1.25,stack=tuft1)' ...
    '|(mouse=10.24.1.25,stack=tuft2)'...
    '|(mouse=10.24.1.25,stack=tuft3)' ...
    ] ));

%db_daan = load_testdb('tptestdb_olympus_daan_cycling_corrected');
db_daan = []; 

%db_rajeev = load_testdb('tptestdb_olympus_rajeev');
db_rajeev = [];

db_rajeev_reverse = load_testdb('tptestdb_olympus_rajeev_check_reverse');
db_rajeev_reverse = db_rajeev_reverse(find_record(db_rajeev_reverse, ...
    ['(mouse=10.24.1.26,stack=tuft1)'...
    '|(mouse=10.24.1.27,stack=tuft2)' ...   
    '|(mouse=10.24.1.28,stack=tuft1)' ...
    '|(mouse=10.24.1.28,stack=tuft3)'
    ] ));


db_nandu = load_testdb('tptestdb_olympus_nandu_chronic');
db_nandu = db_nandu(find_record(db_nandu, ...
    ['(mouse=10.24.1.27,stack=tuft1)']));

%monocular MD data
db_rajeev_mono = load_testdb('tptestdb_olympus_rajeev_mono_ctx_reverse');
db_rajeev_mono = db_rajeev_mono(find_record(db_rajeev_mono, ...
    ['(mouse=10.24.2.38,stack=tuft3-mono)' ...
    '|(mouse=10.24.2.40,stack=tuft3-mono)' ...
    '|(mouse=10.24.2.40,stack=tuft4-mono)' ...
    ] ));

db_rajeevdaan_mono = load_testdb('tptestdb_olympus_MC_DvV_partI_reverse');
db_rajeevdaan_mono = db_rajeevdaan_mono(find_record(db_rajeevdaan_mono, ...
    ['(mouse=10.24.1.28,stack=tuft4-mono)']));

db_rajeevdaanr_mono = load_testdb('tptestdb_olympus_daan_MC_reverse');
db_rajeevdaanr_mono = db_rajeevdaanr_mono(find_record(db_rajeevdaanr_mono, ...
    ['(mouse=10.24.2.70,stack=tuft2)']));

%Control data
db_rajeev_bsln = load_testdb('tptestdb_olympus_rajeev_home');
db_rajeev_bsln = db_rajeev_bsln(find_record(db_rajeev_bsln, ...
    ['(mouse=10.24.2.38,stack=tuft2)' ] ));
    

 db_rajeev_bsln_reverse = load_testdb('tptestdb_olympus_rajeev_check_reverse');
 db_rajeev_bsln_reverse = db_rajeev_bsln_reverse(find_record(db_rajeev_bsln_reverse, ...
     [  ...%'(mouse=10.24.2.16,stack=tuft1)'... % temporary to deal with missing tp
     '(mouse=10.24.2.38,stack=tuft1)'] ));
 
db_daan_bsln = load_testdb('tptestdb_olympus_daan_bsln');
db_daan_bsln = db_daan_bsln(find_record(db_daan_bsln, ...
    ['(mouse=10.24.2.18,stack=tuft2)'] ));

 db_daan_home = load_testdb('tptestdb_olympus_daan_home');
 db_daan_home = db_daan_home(find_record(db_daan_home, ...
     ['(mouse=10.24.2.40,stack=tuft1)|'...
     '(mouse=10.24.2.40,stack=tuft2)' ] ));

%Repetitive data (added 2012-01-25 by DVV)
db_daan_rep = load_testdb('tptestdb_olympus_repeated');
db_daan_rep = db_daan_rep(find_record(db_daan_rep, ...
    ['mouse=10.24.2.56,stack=tuft1'] ));

 %Immunohistochemistry data

%warning('Temporary using old daan imm db');
db_daan_imm = load_testdb('tptestdb_olympus_daan_imm');
db_daan_imm = db_daan_imm(find_record(db_daan_imm, ...
   ['(mouse=11.21.3.02,stack=stack1,date=2011-07-29)|' ...
    '(mouse=11.21.3.02,stack=stack2,date=2011-07-29)|' ...
    '(mouse=11.21.3.02,stack=stack3,date=2011-07-29)|' ...
    '(mouse=11.21.3.06)|' ...
    '(mouse=11.21.3.07)|' ...
    '(mouse=11.21.3.08)|' ...
    '(mouse=11.21.3.09)|' ...
    '(mouse=11.21.3.05,stack=stack1,date=2011-08-08)|' ...
    '(mouse=11.21.3.05,stack=stack2,date=2011-08-08)' ...
    ] ));

warning('LOAD_TPTESTDB_FOR_ANALYSIS: only taking part of Nandu');
db_nandu_imm = load_testdb('tptestdb_olympus_nandu_imm');
db_nandu_imm = db_nandu_imm(find_record(db_nandu_imm, ...
   ['(mouse=11.21.3.01,stack=PVCy5-geph-red-63x2.2-slice1-layer1-2-stack1,date=2011-07-28)|' ...
    '(mouse=11.21.3.01,stack=PVCy5-geph-red-63x2.2-slice1-layer1-2-stack2,date=2011-07-28)|' ...
    '(mouse=11.21.3.01,stack=PVCy5-geph-red-63x2.2-slice1-layer1-2-stack3,date=2011-07-28)|' ...
    '(mouse=11.21.3.01,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer1-2-stack1,date=2011-08-10)|' ...
    '(mouse=11.21.3.01,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer1-2-stack2,date=2011-08-10)|' ...
    '(mouse=11.21.3.01,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer1-2-stack3,date=2011-08-10)|' ...
    '(mouse=11.21.3.02,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer2-stack1,date=2011-08-10)|' ...
    '(mouse=11.21.3.02,stack=Sy2Cy5-geph-red-63x2.2-slice2-layer2-stack1,date=2011-08-10)|' ...
    '(mouse=11.21.3.02,stack=Sy2Cy5-geph-red-63x2.2-slice2-layer2-stack2,date=2011-08-10)|' ...
    '(mouse=11.21.3.02,stack=CBCy5-geph-red-63x2.2-slice2-layer1-2-stack1,date=2011-08-18)|' ...
    '(mouse=11.21.3.02,stack=CBCy5-geph-red-63x2.2-slice2-layer1-2-stack2,date=2011-08-18)|' ...
    '(mouse=11.21.3.02,stack=CBCy5-geph-red-63x2.2-slice3-layer2-stack1,date=2011-08-18)|' ...
    '(mouse=11.21.3.02,stack=CBCy5-geph-red-63x2.2-slice3-layer1-2-stack2,date=2011-08-18)|' ...
    '(mouse=11.21.3.02,stack=CBCy5-geph-red-63x2.2-slice4-layer1-2-stack1,date=2011-08-18)|' ...
    '(mouse=11.21.3.03,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer1-2-stack2,date=2011-07-27)|' ...
    '(mouse=11.21.3.03,stack=Sy2Cy5-geph-red-63x2.2-slice2-layer1-2-stack1,date=2011-07-27)|' ...
    '(mouse=11.21.3.03,stack=CBCy5-geph-red-63x2.2-slice2-layer2-stack1,date=2011-08-18)|' ...
    '(mouse=11.21.3.03,stack=CBCy5-geph-red-63x2.2-slice3-layer1-2-stack2,date=2011-08-19)|' ...
    '(mouse=11.21.3.03,stack=CBCy5-geph-red-63x2.2-slice4-layer1-2-stack2,date=2011-08-19)|' ...
    '(mouse=11.21.3.04,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer2-stack1,date=2011-08-04)|' ...
    '(mouse=11.21.3.04,stack=Sy2Cy5-geph-red-63x2.2-slice2-layer2-stack1,date=2011-08-04)|' ...
    '(mouse=11.21.3.05,stack=PVCy5-geph-red-63x2.2-slice1-layer1-2-stack1,date=2011-07-28)|' ...
    '(mouse=11.21.3.05,stack=PVCy5-geph-red-63x2.2-slice3-layer1-2-stack2,date=2011-08-01)|' ... 
    '(mouse=11.21.3.05,stack=Sy2Cy5-geph-red-63x2.2-slice1-layer2-stack2,date=2011-08-04)|' ...
    '(mouse=11.21.3.05,stack=Sy2Cy5-geph-red-63x2.2-slice2-layer2-stack3,date=2011-08-04)' ...
    ] ));

db_vgat = load_testdb('tptestdb_olympus_VGAT');
db_vgat = db_vgat(find_record(db_vgat, ...
   ['(mouse>11.21.3.05,mouse<11.21.3.11)']));

db_dorette_imm = load_testdb('tptestdb_olympus_dorette');
db_dorette_imm = db_dorette_imm(find_record(db_dorette_imm, ...
   ['(mouse=11.21.12022p37*)'] ));

db_martine_imm = load_testdb('tptestdb_olympus_martine');
db_martine_imm = db_martine_imm(find_record(db_martine_imm, ...
   ['(mouse=11.21.12022p37*)'] ));

db= [ db_daan db_rajeev db_nandu ...
    db_rajeev_bsln  db_rajeev_reverse db_rajeev_bsln_reverse db_rajeev_mono db_rajeevdaan_mono db_rajeevdaanr_mono ...
    db_daan_bsln db_daan_matched db_daan_home db_daan_imm db_nandu_imm db_vgat db_daan_rep db_dorette_imm db_martine_imm];

switch host
    case {'giskard','eto'}
        save(fullfile(expdatabasepath,'tptestdb_olympus_alexander'),'db');
end


